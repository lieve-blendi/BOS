do local a={"/boot/kernel/pipes","/OS.lua","/init.lua"}local b=component;local c=computer;local d=b.invoke;local e=b.list;local f=b.proxy;local function g(h,i,...)local j=table.pack(pcall(d,h,i,...))if not j[1]then return nil,j[2]else return table.unpack(j,2,j.n)end end;local function k(l)local m=f(l)for n,o in ipairs(a)do if m.exists(o)then return o end end end;local function p(q)local r=e("internet")()if not r then return end;local s=f(r)local t,u=s.request(q)local j=""while true do u=t.read(math.huge)if u then j=j..u else break end end;t.close()return j end;local function v(w)local x=f(w)local y=x.list("/")for z,o in ipairs(y)do x.remove(o)end;x.setLabel(nil)end;local A=e("eeprom")()c.getBootAddress=function()return g(A,"getData")end;c.setBootAddress=function(h)return g(A,"setData",h)end;local B=e("screen")()local C=f(e("gpu")())if C and B then g(C,"bind",B)end;if not C then error("No graphics card available")end;local D,E=C.getResolution()C.setForeground(0xFFFFFF)C.setBackground(0)C.fill(1,1,D,E," ")local F=C.set;F(1,1,"Wings BIOS")F(1,2,"Press left control to boot BIOS")local function G(w)c.setBootAddress(w)C.fill(1,1,D,E," ")F(1,1,"Booting in "..w.."...")local H=k(w)local t,I=g(w,"open",H)if not t then return nil,I end;local J=""repeat local K,I=g(w,"read",t,math.huge)if not K and I then return nil,I end;J=J..(K or"")until not K;g(w,"close",t)return load(J,"="..H)end;local function L()local M=G(c.getBootAddress())if M then M()else for N in e("filesystem")do M=G(N)if M then return M()end end;if M then M()else error("No bootable device found")end end end;local O=c.pullSignal;do local P,Q,Q,R=O(3)if P~="key_down"or R~=29 then L()end end;local S="touch"local T="m"local U=""local V=""local W=""local X=""while true do C.fill(1,1,D,E," ")local Y={}local Z={}for N in e("filesystem")do local _=f(N)if c.tmpAddress()~=N then table.insert(Y,N)local a0=""if c.getBootAddress()==N then a0=" < Default boot drive"end;local a1=_.getLabel()local a2=math.floor(_.spaceUsed()/1048576*100)/100;local a3=math.floor(_.spaceTotal()/1048576*100)/100;if a1 then table.insert(Z,a1 .." ("..string.sub(N,1,8)..") ("..a2 .."/"..a3 .."MB used)"..a0)else table.insert(Z,string.sub(N,1,8).." ("..a2 .."/"..a3 .."MB used)"..a0)end end end;if T=="m"then local a4={"Wings BIOS","","Drives","Update BIOS"}for n,o in ipairs(a4)do F(1,n,o)end;local P,Q,a5,a6=O()if P==S then for n,o in ipairs(a4)do if a6==n then if a5>=1 and a5<=#o then if n==3 then T="d"elseif n==4 then local a7=p("https://raw.githubusercontent.com/lieve-blendi/BOS/main/firmware/Wings/minified.lua")if a7 then g(A,"set",a7)W="Sucessfully updated!"X="m"T="e"else W="No internet card detected"X="m"T="e"end end end end end end end;if T=="d"then local a4={"Boot normally","Back"}for n=#Z,1,-1 do table.insert(a4,1,Z[n])end;for n,o in ipairs(a4)do F(1,n,o)end;local P,Q,a5,a6=O()if P==S then for n,o in ipairs(a4)do if a6==n then if a5>=1 and a5<=#o then if n<=#Z then U=Y[n]V=Z[n]T="ds"elseif n==#Z+1 then L()elseif n==#Z+2 then T="m"end end end end end end;if T=="ds"then local a4={V,"","Erase Drive","Boot Drive","Back"}for n,o in ipairs(a4)do F(1,n,o)end;local P,Q,a5,a6=O()if P==S then for n,o in ipairs(a4)do if a6==n then if a5>=1 and a5<=#o then if n==3 then T="es"elseif n==4 then local M=G(U)if M then M()else W="Drive failed to boot"X="ds"T="e"end elseif n==5 then T="d"U=""end end end end end end;if T=="es"then local a4={"Are you sure you want to erase this drive?","","Yes","No"}for n,o in ipairs(a4)do F(1,n,o)end;local P,Q,a5,a6=O()if P==S then for n,o in ipairs(a4)do if a6==n then if a5>=1 and a5<=#o then if n==3 then v(U)T="d"U=""elseif n==4 then T="d"U=""end end end end end end;if T=="e"then local a4={W,"","Back"}for n,o in ipairs(a4)do F(1,n,o)end;local P,Q,a5,a6=O()if P==S then for n,o in ipairs(a4)do if a6==n then if a5>=1 and a5<=#o then if n==3 then T=X end end end end end end end end
